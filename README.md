# ml-cw2

## Quick Start

Follow these steps to set up the environment and execute the training pipeline.

### 1. Installation
Ensure you have Python 3.10 installed. Install the required dependencies using `pip`:

```bash
pip install -r requirements.txt
```

### 2. Data
In order to run the experiments make sure your data structure follows the structure below
*   Images: `*_img.nii.gz`
*   Masks: `*_mask.nii.gz`

### 3. Run experiments
Run the following in order to run very experiment outlined in the report
```bash
python experiment.py
```
The script expects the data to be located in ```./data")```. If you want to change the default path you can do it by changing the ```DATA_DIR``` variable.

The scripts includes the following experiments:
*   **resnet_weighted_ce1**: Weighted Dice + Cross-Entropy loss.

*   **resnet_weighted_ce0**: Investigates a Dice-only loss by setting Cross-Entropy weight to 0.

*   **resnet_unweighted**: A baseline network without the custom class-weighting matrix.

*   **resnet_sens_only**: Evaluates performance using only the Sensitivity-based weight matrix.

*   **resnet_dist_only**: Evaluates performance using only the Distance-based weight matrix.

### 4. Evaluation
#### 4.1. Generate the model's predictions
Run the ```evaluate.py``` script to generate the predictions from the trained model.
The script uses these default paths which you can change depending on your setup
*  ```DATA_DIR = Path("./data")``` - the data path
*  ```WEIGHT_PATH = "checkpoints/best_model.pth"``` - this should be the path to the model you are evaluating
*  ```OUTPUT_DIR = Path("./predictions")``` - the directory for the generated predictions

#### 4.2. Get the evaluations
Run the ```evaluate_predictions.py``` script to generate the DICE scores for your predictions.
*   ```DATA_DIR = Path("./data")``` - the data path
*   ```PRED_DIR = Path("./predictions/best_model")``` - the predictions generated by the ```evaluate.py``` script



